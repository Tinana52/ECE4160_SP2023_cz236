<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>ECE4160 Canwen</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Font Awesome icons (free version)-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js"
        crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet"
        type="text/css" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet" />
    <!-- Fonts CSS-->
    <link rel="stylesheet" href="css/heading.css">
    <link rel="stylesheet" href="css/body.css">
</head>

<body id="page-top">
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg bg-secondary text-uppercase fixed-top" id="mainNav">
        <div class="container">
            <a class="navbar-brand" href="#page-top">CORNELL FAST ROBOTS</a>
            <button class="navbar-toggler text-uppercase font-weight-bold bg-primary text-white rounded" type="button"
                data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive"
                aria-expanded="false" aria-label="Toggle navigation">
                Menu
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded"
                            href="#portfolio">Labs</a></li>
                    <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded" href="#about">About
                            Me</a></li>
                    <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded"
                            href="#contact">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Masthead-->
    <header class="masthead bg-primary text-white text-center">
        <div class="container d-flex align-items-center flex-column">
            <!-- Masthead Avatar Image-->
            <img class="masthead-avatar mb-5" src="assets/img/PngItem_1798236.png" alt="..." />
            <!-- Masthead Heading-->
            <h1 class="masthead-heading text-uppercase mb-0">ECE4160 FAST ROBOTS</h1>
            <!-- Icon Divider-->
            <div class="divider-custom divider-light">
                <div class="divider-custom-line"></div>
                <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                <div class="divider-custom-line"></div>
            </div>
            <!-- Masthead Subheading-->
            <p class="masthead-subheading font-weight-light mb-0">Canwen Zhang | Spring 2023</p>
        </div>
    </header>
    <!-- Portfolio Section-->
    <section class="page-section portfolio" id="portfolio">
        <div class="container">
            <!-- Portfolio Section Heading-->
            <h2 class="page-section-heading text-center text-uppercase text-secondary mb-0">Labs</h2>
            <!-- Icon Divider-->
            <div class="divider-custom">
                <div class="divider-custom-line"></div>
                <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                <div class="divider-custom-line"></div>
            </div>
            <!-- Portfolio Grid Items-->
            <div class="row justify-content-center">
                <!-- Portfolio Item 1-->
                <div class="col-md-6 col-lg-4 mb-5">
                    <div class="portfolio-item mx-auto" data-bs-toggle="modal" data-bs-target="#portfolioModal1">
                        <div
                            class="portfolio-item-caption d-flex align-items-center justify-content-center h-100 w-100">
                            <div class="portfolio-item-caption-content text-center text-white"><i
                                    class="fas fa-plus fa-3x"></i></div>
                        </div>
                        <img class="img-fluid" src="assets/img/portfolio/Lab1.png" alt="Lab1" />
                    </div>
                </div>
                <!-- Portfolio Item 2-->
                <div class="col-md-6 col-lg-4 mb-5">
                    <div class="portfolio-item mx-auto" data-bs-toggle="modal" data-bs-target="#portfolioModal2">
                        <div
                            class="portfolio-item-caption d-flex align-items-center justify-content-center h-100 w-100">
                            <div class="portfolio-item-caption-content text-center text-white"><i
                                    class="fas fa-plus fa-3x"></i></div>
                        </div>
                        <img class="img-fluid" src="assets/img/portfolio/Lab2.png" alt="Lab2" />
                    </div>
                </div>
                <!-- Portfolio Item 3-->
                <div class="col-md-6 col-lg-4 mb-5">
                    <div class="portfolio-item mx-auto" data-bs-toggle="modal" data-bs-target="#portfolioModal3">
                        <div
                            class="portfolio-item-caption d-flex align-items-center justify-content-center h-100 w-100">
                            <div class="portfolio-item-caption-content text-center text-white"><i
                                    class="fas fa-plus fa-3x"></i></div>
                        </div>
                        <img class="img-fluid" src="assets/img/portfolio/Lab3.png" alt="Lab3" />
                    </div>
                </div>
                <!-- Portfolio Item 4-->
                <div class="col-md-6 col-lg-4 mb-5 mb-lg-0">
                    <div class="portfolio-item mx-auto" data-bs-toggle="modal" data-bs-target="#portfolioModal4">
                        <div
                            class="portfolio-item-caption d-flex align-items-center justify-content-center h-100 w-100">
                            <div class="portfolio-item-caption-content text-center text-white"><i
                                    class="fas fa-plus fa-3x"></i></div>
                        </div>
                        <img class="img-fluid" src="assets/img/portfolio/tobecontinued.png" alt="Lab4" />
                    </div>
                </div>
                <!-- Portfolio Item 5-->
                <div class="col-md-6 col-lg-4 mb-5 mb-md-0">
                    <div class="portfolio-item mx-auto" data-bs-toggle="modal" data-bs-target="#portfolioModal5">
                        <div
                            class="portfolio-item-caption d-flex align-items-center justify-content-center h-100 w-100">
                            <div class="portfolio-item-caption-content text-center text-white"><i
                                    class="fas fa-plus fa-3x"></i></div>
                        </div>
                        <img class="img-fluid" src="assets/img/portfolio/tobecontinued.png" alt="Lab5" />
                    </div>
                </div>
                <!-- Portfolio Item 6-->
                <div class="col-md-6 col-lg-4">
                    <div class="portfolio-item mx-auto" data-bs-toggle="modal" data-bs-target="#portfolioModal6">
                        <div
                            class="portfolio-item-caption d-flex align-items-center justify-content-center h-100 w-100">
                            <div class="portfolio-item-caption-content text-center text-white"><i
                                    class="fas fa-plus fa-3x"></i></div>
                        </div>
                        <img class="img-fluid" src="assets/img/portfolio/tobecontinued.png" alt="Lab6" />
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- About Section-->
    <section class="page-section bg-primary text-white mb-0" id="about">
        <div class="container">
            <!-- About Section Heading-->
            <h2 class="page-section-heading text-center text-uppercase text-white">About Me</h2>
            <!-- Icon Divider-->
            <div class="divider-custom divider-light">
                <div class="divider-custom-line"></div>
                <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                <div class="divider-custom-line"></div>
            </div>
            <!-- About Section Content-->
            <div class="row">
                <div class="col-lg-6 ">
                    <p class="pre-wrap lead mb-3">Hi! I'm Canwen, an ECE undergrad minor in CS at Cornell. My academic
                        interests lies in robotics and embeded systems.
                    <p class="pre-wrap lead">This webpage is used to document labs in ECE 4160: Fast Robots (Spring
                        2023). Below you can find links to each of the labs. </p>
                </div>
                <div class="col ">
                    <img class="img-fluid" src="assets/img/CanwenZhangpicture.jpg" width="510" height="170">
                </div>
                <div class="col mr-auto">
                    <p class="mb-5"> </p>
                </div>
            </div>
        </div>
    </section>
    <!-- Contact Section-->
    <section class="page-section" id="contact">
        <div class="container">
            <!-- Contact Section Heading-->
            <h2 class="page-section-heading text-center text-uppercase text-secondary mb-0">Contact Me</h2>
            <!-- Icon Divider-->
            <div class="divider-custom">
                <div class="divider-custom-line"></div>
                <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                <div class="divider-custom-line"></div>
            </div>
            <!-- Contact Section Form-->
            <div class="row justify-content-center">
                <div class="col-lg-4">
                    <div class="d-flex flex-column align-items-center">
                        <div class="icon-contact mb-3"><i class="fas fa-envelope" style="font-size:60px;"></i></div>
                        <div class="text-muted">Email</div>
                        <div class="lead font-weight-bold">cz236@cornell.edu</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Copyright Section-->
    <div class="copyright py-4 text-center text-white">
        <div class="container"><small>Copyright &copy; Canwen Zhang 2023</small></div>
    </div>












    <!-- Portfolio Modals-->
    <!-- Portfolio Modal 1-->
    <div class="portfolio-modal modal fade" id="portfolioModal1" tabindex="-1" aria-labelledby="portfolioModal1"
        aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header border-0"><button class="btn-close" type="button" data-bs-dismiss="modal"
                        aria-label="Close"></button></div>
                <div class="modal-body text-center pb-5">
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8">
                                <!-- Portfolio Modal - Title-->
                                <h2 class="portfolio-modal-title text-secondary text-secondary mb-0">Lab 1: The Artemis
                                    board</h2>
                                <!-- Icon Divider-->
                                <div class="divider-custom">
                                    <div class="divider-custom-line"></div>
                                    <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                                    <div class="divider-custom-line"></div>
                                </div>
                                <!-- Portfolio Modal - Text-->
                                <h3 align="left">Objective</h3>
                                <p align="left">The purpose of this lab is to familiarize us with the Arduino IDE and
                                    the Artemis board. Specifically, we will run four example code scripts on the
                                    SparkFun RedBoard Artemis Nano board. </p>
                                <img src="assets/img/lab1/board.png" class="img-thumbnail" alt="...">
                                <br><br>
                                <h3 align="left">Examples</h3>
                                <br>
                                <h4 align="left">1. Blink</h4>
                                <p align="left">In this example we blink the LED on the board by calling the
                                    digitalWrite function and set LED_BUILTIN to HIGH or LOW. To double check, I added
                                    two println statements that showed the current state of LED on the serial monitor.
                                    See the video below.</p>
                                <img class="img-fluid" src="assets/img/lab1/lab1a.png">
                                <iframe width="389" height="692" src="https://www.youtube.com/embed/MpS9VeCLeJE"
                                    title="Lab1a" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></iframe>
                                <br><br>
                                <h4 align="left">2. Serial</h4>
                                <p align="left">In this example we tested the serial communication between the board and
                                    the computer. The Apollo3 contains two UART peripherals that can be used with the
                                    Arduino Serial api. One thing to note is that we need to match the baud rate we set
                                    in code with the baud rate appears on the bottom right of the serial monitor.
                                    Otheriwse, the output will not be what you would expected.</p>
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/G3tKfnmNyQs"
                                    title="YouTube video player" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></iframe>
                                <br><br>
                                <h4 align="left">3. Analog Read</h4>
                                <p align="left">The Apollo3 has some internal ADC channels that allow us to measure:</p>
                                <p align="left"> - differential pairs</p>
                                <p align="left"> - the internal die temperature</p>
                                <p align="left"> - the internal VCC voltage</p>
                                <p align="left"> - the internal VSS voltage</p><br>
                                <p align="left">In this example we could see the usage of analogRead by fading the
                                    built-in LED to match the voltage read in on one of the analog pins. Additionally
                                    some of the internal ADC connections are used to measure the die temperature and VCC
                                    levels.</p>
                                <p align="left">In the video below, I heated up the chip by putting it in contact with a
                                    hot water plastic bag, and we can see data in the "temp (counts)" column (represents
                                    raw ADC counts from die temperature sensor) gradually increased. </p>
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/nYJqPeb7BAg"
                                    title="YouTube video player" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></iframe>
                                <br><br>
                                <h4 align="left">4. Microphone Output</h4>
                                <p align="left">The last example demonstrates how to use the pulse density microphone
                                    (PDM) on Artemis boards. The serial monitor prints out the loudest frequency heard
                                    by the microphone on the board. As I whistled from high frequency to low frequency,
                                    the data displayed also decreased, as shown in the video below.</p>
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/9YmdSi6pJK0"
                                    title="YouTube video player" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></iframe>


                                <button class="btn btn-primary" data-bs-dismiss="modal">
                                    <i class="fas fa-xmark fa-fw"></i>
                                    Close Window
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Portfolio Modal 2-->
    <div class="portfolio-modal modal fade" id="portfolioModal2" tabindex="-1" aria-labelledby="portfolioModal2"
        aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header border-0"><button class="btn-close" type="button" data-bs-dismiss="modal"
                        aria-label="Close"></button></div>
                <div class="modal-body text-center pb-5">
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8">
                                <!-- Portfolio Modal - Title-->
                                <h2 class="portfolio-modal-title text-secondary text-uppercase mb-0">Lab2: Bluetooth
                                </h2>
                                <!-- Icon Divider-->
                                <div class="divider-custom">
                                    <div class="divider-custom-line"></div>
                                    <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                                    <div class="divider-custom-line"></div>
                                </div>
                                <!-- Portfolio Modal - Text-->
                                <h3 align="left">Objective</h3>
                                <p align="left">The purpose of this lab is to establish communication between pc and the
                                    Artemis board through the Bluetooth stack. We will be using Python inside a Jupyter
                                    notebook on the computer end and the Arduino programming language on the Artemis
                                    side. We will also establish a framework for sending data via Bluetooth that will be
                                    useful in future labs. </p>
                                <br><br>
                                <h3 align="left">Prelab</h3>
                                <h4 align="left">Setup:</h4>
                                <p align="left">Before starting to work on any lab tasks, I first installed Python 3 and
                                    pip as well as created a virtual environment for my lab2 folder. Then, to activate
                                    the virtual environment, I “cd” to the folder and used the command: </p>
                                <code>source FastRobots_ble/bin/activate</code>
                                <br>
                                <p align="left">Now my CLI prompt should have the prefix (FastRobots_ble). </p>
                                <p align="left">For the python code, We will be using Jupyter notebooks, which can be
                                    opened by this command: </p>
                                <code>jupyter lab </code>
                                <br><br>
                                <h4 align="left">Codebase: </h4>
                                <p align="left">The codebase consists of two subfolders: ble_arduino and ble_python. The
                                    former one includes ble_arduino.ino (which will run on the Artemis board) and
                                    necessary class definitions. The latter one includes demo.ipynb (which is the main
                                    Jupyter Notebook to run commands and setup the bluetooth connection between pc and
                                    the Artemis board) and functions that handle BLE operations. Below is a video
                                    running the default cells in demo.ipynb. </p>
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/J1kaAk9ScBI"
                                    title="YouTube video player" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></iframe>
                                <br><br>
                                <h4 align="left">Configuration:</h4>
                                <p align="left">Before doing any tasks, we need first made the necessary configurations
                                    to establish a stable connection between the BLE device and our PC. I updated the
                                    connections.yaml with the displayed MAC address from running ble_arduino.ino. </p>
                                <img src="assets/img/lab2/lab2setup1.png" class="img-thumbnail" alt="...">
                                <p align="left">Then I changed the default BLEService UUID with the newly generated UUID
                                    in both ble_arduino.ino and connection.yaml to avoid connecting to my classmates’
                                    Artemis boards. </p>
                                <img src="assets/img/lab2/lab2setup2.png" class="img-thumbnail" alt="...">
                                <br><br>
                                <br><br>
                                <h3 align="left">Lab Tasks </h3>
                                <h4 align="left">Task1: Send Echo Command </h4>
                                <p align="left"> An Echo command returns the augmented version of the message that was
                                    sent to it. In ble_arduino.ino, we add a new case ECHO similar to the given PING
                                    case. Note that when adding a new switch case, we need to update enum CommandTypes
                                    in ble_arduino.ino and cmd_types.py in Jupyter Notebook. </p>
                                <img src="assets/img/lab2/echo.png" class="img-thumbnail" alt="...">
                                <p align="left">In Jupyter notebook, we send command: </p>
                                <img src="assets/img/lab2/sendecho.png" class="img-thumbnail" alt="...">
                                <p align="left">In Arduino’s Serial Monitor the result will be: </p>
                                <img src="assets/img/lab2/outputecho.png" class="img-thumbnail" alt="...">
                                <br><br>
                                <h4 align="left">Task2: Get Time Command </h4>
                                <p align="left">This task is similar to the previous one, except that now instead of
                                    passing the string value from the pc, the millis() was used to get the current time
                                    in milliseconds </p>
                                <p align="left">Add the switch case: </p>
                                <img src="assets/img/lab2/time.png" class="img-thumbnail" alt="...">
                                <p align="left">In Jupyter notebook, we send command: </p>
                                <img src="assets/img/lab2/sendtime.png" class="img-thumbnail" alt="...">
                                <p align="left">In Arduino’s Serial Monitor the result will be: </p>
                                <img src="assets/img/lab2/outputtime.png" class="img-thumbnail" alt="...">
                                <br><br>
                                <h4 align="left">Task3: Notification Handler </h4>
                                <p align="left">In Jupyter Notebook, ble.start_notify(ble.uuid['RX_STRING'],
                                    callback_function) will automatically fill the two inputs (uuid and byte_array) of
                                    the callback_function. So in callback_function we only need to convert the raw value
                                    of byte_array to string in order for printing. After calling ble.send_command(), the
                                    notification handler will keep running to receive any corresponding data from
                                    bluetooth. The difference between this task and task 2 is that we no longer need to
                                    call ble.receive_string() to manually receive data; instead, the notification
                                    handler will do this for us. </p>
                                <img src="assets/img/lab2/task3.png" class="img-thumbnail" alt="...">
                                <br><br>
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/l_41p-dOTu0"
                                    title="YouTube video player" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></iframe>
                                <br><br>
                                <h4 align="left">Task4: Get Temperature Command </h4>
                                <p align="left">This command sends an array of five timestamped internal die temperature
                                    readings using a string array and taken once per second for five seconds. Using
                                    similar basic structure as task 1 and 2, we need to add a loop for collecting one
                                    set of data per second. </p>
                                <img src="assets/img/lab2/5s.png" class="img-thumbnail" alt="...">
                                <p align="left">In Jupyter Notebook, I wrote a callback_function to collect and
                                    rearrange the data into two arrays, time_array and temp_array, respectively. </p>
                                <img src="assets/img/lab2/send5s.png" class="img-thumbnail" alt="...">
                                <br><br>
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/WDM3lpW1FQ8"
                                    title="YouTube video player" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></iframe>
                                <br><br>
                                <h4 align="left">Task5: Get Temperature_Rapid Command </h4>
                                <p align="left">Similar to the previous task, we need to collect and send time and
                                    temperature data. The only difference is that we need to process more sets of data
                                    over the same 5 second interval while not exceeding the characteristic size limit of
                                    151. To do this, I created a variable start_time to keep track of the elapsed time
                                    and while the elapsed time is smaller than 5 seconds, we keep collecting and sending
                                    data five per set to avoid going beyond MAX_MSG_SIZE. </p>
                                <img src="assets/img/lab2/rapid.png" class="img-thumbnail" alt="...">
                                <p align="left">In Jupyter Notebook, I wrote a callback_function to collect and
                                    rearrange the data for printing. </p>
                                <img src="assets/img/lab2/sendrapid.png" class="img-thumbnail" alt="...">
                                <br><br>
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/T4BjHp1s8Y8"
                                    title="YouTube video player" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></iframe>
                                <br><br>
                                <h4 align="left">Task6: Limitations </h4>
                                <p align="left">To address the problem with memory limitation and latency, the robot
                                    needs to handle all real-time processing on-board, and communicate results in chunks
                                    with computer.</p>
                                <p align="left">The Artemis board has 384 kB of RAM, which is 384000 Bytes of memory. If
                                    all of these memory are available for use, and we are sending 5 seconds of 16-bit(=
                                    2 Bytes) data taken at 150 Hz, then we can store 384000/(5*2*150) = 256 groups of
                                    such data before running out of memory. </p>




                                <p class="mb-4">To be continued...</p>
                                <button class="btn btn-primary" data-bs-dismiss="modal">
                                    <i class="fas fa-xmark fa-fw"></i>
                                    Close Window
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Portfolio Modal 3-->
    <div class="portfolio-modal modal fade" id="portfolioModal3" tabindex="-1" aria-labelledby="portfolioModal3"
        aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header border-0"><button class="btn-close" type="button" data-bs-dismiss="modal"
                        aria-label="Close"></button></div>
                <div class="modal-body text-center pb-5">
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8">
                                <!-- Portfolio Modal - Title-->
                                <h2 class="portfolio-modal-title text-secondary text-uppercase mb-0">Lab 3: Time of
                                    Flight Sensors</h2>
                                <!-- Icon Divider-->
                                <div class="divider-custom">
                                    <div class="divider-custom-line"></div>
                                    <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                                    <div class="divider-custom-line"></div>
                                </div>
                                <!-- Portfolio Modal - Text-->
                                <h3 align="left">Objective</h3>
                                <p align="left">The purpose of this lab is to equip the robot with sensors by connecting
                                    the Artemis board to two VL53L1X Time-of-Flight Distance Sensors. We would do
                                    soldering stuff, run example codes, test sensor’s accuracy, and write code for two
                                    sensors working simultaneously. </p>
                                <h3 align="left">Prelab</h3>
                                <p align="left">The default I2C address of the ToF sensors, as included in its
                                    datasheet, is 0x52. </p>
                                <img src="assets/img/lab3/I2C.png" class="img-thumbnail" alt="...">
                                <p align="left">To use two ToF sensors concurrently, we have to solve the address
                                    conflict by either changing the address programmatically (while powered) or enabling
                                    the two sensors separately through their shutdown pins. I decided to use the former
                                    approach since it allows us to communicate with both ToF sensors simultaneously
                                    without having to shut down either one of the sensors, which could reduce delays for
                                    collecting sensor data. </p>
                                <p align="left">To detect distance in multiple views, I decided to place one ToF sensor
                                    at the front of my robot and the other one on the right of robot. However, in cases
                                    where an obstacle appears to the left or to the back, we would not be able to detect
                                    it. </p>
                                <h3 align="left">Lab tasks</h3>
                                <h4 align="left">Task1: Connecting Hardware</h4>
                                <p align="left">By convention, the red wire was soldered to Vin, the black wire was
                                    soldered to GND, the blue wire was soldered to SDA, and the yellow wire was soldered
                                    to SCL. I also soldered XSHUT pin of sensor1 to the output pin GPIO_02 and XSHUT pin
                                    of sensor2 to the output pin GPIO_03 for later use. </p>
                                <p align="left">Below is the picture of ToF sensors connected to the QWIIC breakout
                                    board and the Artemis board:</p>
                                <img src="assets/img/lab3/setup.png" class="img-thumbnail" alt="...">
                                <img src="assets/img/lab3/wire.png" class="img-thumbnail" alt="...">
                                <br><br>
                                <h4 align="left">Task2: Artemis scanning for I2C device</h4>
                                <p align="left">To get familiar with the I2C library, we run the example code in
                                    File->Examples->Apollo3->Wire and open Example1_wire_I2C. We found that the output
                                    address was 0x29. </p>
                                <img src="assets/img/lab3/port.png" class="img-thumbnail" alt="...">
                                <p align="left">However, the default address shown on data sheet is 0x52. This is
                                    because the address is a bit shifted and the LSB is for the read/write status. In
                                    other words, since 0x52 = 0x29 << 1, so the addresses match. </p>
                                        <br><br>
                                        <h4 align="left">Task3: Sensor data & chosen mode</h4>
                                        <p align="left">The ToF sensor has three modes: </p>
                                        <img src="assets/img/lab3/modes.png" class="img-thumbnail" alt="...">
                                        <p align="left">The long distance mode allows the longest possible ranging
                                            distance of 360cm to be reached. However, this distance can be impacted by
                                            ambient light. The short distance more is more immune to ambient light, but
                                            its max distance is only 136cm. For my robot, I plan to use the short
                                            distance mode with the command: </p>
                                        <code>.setDistanceModeShort(); //1.3m </code>
                                        <p align="left">To test my chosen mode, I used example code in
                                            “..\Arduino\libraries\SparkFun_VL53L1X_4m_Laser_Distance_Sensor\examples\Example1_ReadDistance”
                                            and plotted the actual distance vs. measured distance graph below using the
                                            average of repeatedly collected data. </p>
                                        <img src="assets/img/lab3/distance.png" class="img-thumbnail" alt="...">
                                        <p align="left">We can see the ToF sensor is pretty accurate within its mode
                                            distance range when the lighting condition is good. I also printed time (in
                                            milliseconds) it takes for the sensor to get data with or without
                                            stopRanging. </p>
                                        <img src="assets/img/lab3/ranging.png" class="img-thumbnail" alt="...">
                                        <br><br>
                                        <h4 align="left">Task4: Two ToF sensors</h4>
                                        <p align="left">As mentioned earlier, to use two ToF sensors simultaneously, I
                                            plan to resolve the sensor address conflict by changing the address of one
                                            sensor programmatically while powered. To be specific, I first shutdown
                                            sensor 2 to change I2C address of sensor 1 to 0x50, and then turn sensor 2
                                            back on. <br><br>
                                            <code align="left">pinMode(2, OUTPUT); <br>
                                        digitalWrite(2, HIGH); <br>

                                        pinMode(3, OUTPUT); <br>
                                        digitalWrite(3, LOW); <br>

                                        distanceSensor1.setI2CAddress(0x50); <br>
                                        digitalWrite(3, HIGH); <br>
                                    </code>
                                        </p>
                                        <p align="left">Below is the video showing two sensors work concurrently. </p>
                                        <iframe width="560" height="315" src="https://www.youtube.com/embed/g1MuljhBgWU"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            allowfullscreen></iframe>
                                        <br><br>
                                        <h4 align="left">Task5: ToF sensor speed</h4>
                                        <p align="left">To see the delays of collecting sensor data, I slightly modified
                                            the code in task 7 by adding the while loop below: <br><br>
                                            <code align="left"> while (!distanceSensor1.checkForDataReady() || !distanceSensor2.checkForDataReady()) <br>
                                        { <br>
                                            int time = millis(); <br>
                                            Serial.print("Time: "); <br>
                                            Serial.print(time); <br>
                                            Serial.println(); <br>
                                        } <br>
                                    </code>
                                        </p>
                                        <p align="left">From the printed output, we could observe that the delays
                                            between two sets of sensor data is approximately 100ms. The the limiting
                                            time factor is the time it takes for the ToF sensors to gather and process
                                            data rather than the Artemis board’s internal clock cycle. </p>
                                        <img src="assets/img/lab3/speed.png" class="img-thumbnail" alt="...">
                                        <br><br>
                                        <h4 align="left">Task6: Data sent over bluetooth</h4>
                                        <p align="left">To record time-stamped ToF data for a set period of time and
                                            then send it over Bluetooth to pc, I added GET_ToF_5s_RAPID case in my lab2
                                            Arduino code and wrote a corresponding callback function in Jupyter
                                            Notebook. The below graph shows distance data gathered over approximately 5
                                            seconds from both sensors. </p>
                                        <iframe width="560" height="315" src="https://www.youtube.com/embed/RNgupbF-Mlc"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            allowfullscreen></iframe>
                                        <img src="assets/img/lab3/plot.png" class="img-thumbnail" alt="...">
                                        <button class="btn btn-primary" data-bs-dismiss="modal">
                                            <i class="fas fa-xmark fa-fw"></i>
                                            Close Window
                                        </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Portfolio Modal 4-->
    <div class="portfolio-modal modal fade" id="portfolioModal4" tabindex="-1" aria-labelledby="portfolioModal4"
        aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header border-0"><button class="btn-close" type="button" data-bs-dismiss="modal"
                        aria-label="Close"></button></div>
                <div class="modal-body text-center pb-5">
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8">
                                <!-- Portfolio Modal - Title-->
                                <h2 class="portfolio-modal-title text-secondary text-uppercase mb-0">Lab 4: IMU</h2>
                                <!-- Icon Divider-->
                                <div class="divider-custom">
                                    <div class="divider-custom-line"></div>
                                    <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                                    <div class="divider-custom-line"></div>
                                </div>
                                <!-- Portfolio Modal - Text-->
                                <h3 align="left">Objective</h3>
                                <p align="left">The purpose of this lab is to add the 9-DoF IMU (which is equipped with
                                    accelerometer and gyroscope that can measure pitch and roll angles when the robot is
                                    running) to my robot, start running the Artemis and sensors from a battery, and
                                    record a stunt on your RC robot. </p>
                                <h3 align="left">Lab tasks</h3>
                                <h4 align="left">Task1: Setup the IMU</h4>
                                <p align="left">First, we connected the IMU to the Artemis board using the QWIIC cable,
                                    as shown below. </p>
                                <img src="assets/img/lab2/IMUsetup.png" class="img-thumbnail" alt="...">
                                <p align="left">We then could run the IMU example code to get data from the
                                    accelerometer and the gyroscope, as shown in the video below. </p>
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/AIuVwJDMUw4"
                                    title="YouTube video player" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></iframe>
                                <p align="left">The accelerometer data changes when I accelerated the IMU back and forth
                                    or up and down, and the gyroscope data changes when I tilt the IMU in different
                                    directions. </p>
                                <br><br>
                                <p align="left">Note that in the example code, the AD0_VAL PIN is defined to be 1 by
                                    default. It should be the value of the last bit of the I2C address. </p>
                                <code>#define AD0_VAL 1 </code>
                                <img src="assets/img/lab4/I2C.png" class="img-thumbnail" alt="...">
                                <p align="left">According to the screenshot above, running the Wire_I2C code gave us the
                                    I2C address of 0x69, the LSB is 1, so the AD0_VAL should be set to 1. </p>
                                <br><br>
                                <p align="left">I also added a function to blink the LED three times slowly on start-up
                                    as a visual indication that the board is running, as shown below. </p>
                                <img src="assets/img/lab4/blink.png" class="img-thumbnail" alt="...">
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/YGmKGVKo91E"
                                    title="YouTube video player" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen></iframe>

                                <br><br>
                                <h4 align="left">Task2: Accelerometer</h4>
                                <p align="left">I used the equations from class to convert accelerometer data into pitch
                                    and roll. </p>
                                <img src="assets/img/lab4/code.png" class="img-thumbnail" alt="...">
                                <p align="left">After playing with the accelerometer for a while, I found that it is
                                    pretty accurate with little deviation of < 2 degrees. The following chart shows the
                                        average roll and pitch data at {-90, 0, 90} degrees. </p>
                                        <img src="assets/img/lab4/chart.png" class="img-thumbnail" alt="...">
                                        <iframe width="560" height="315" src="https://www.youtube.com/embed/hDrxx23NIso"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            allowfullscreen></iframe>
                                        <br><br>
                                        <p align="left">To see the noise level of accelerometer data, I collected 150
                                            sets of pitch and roll data in 5 seconds by sending data over bluetooth to
                                            my pc, and then analyzed the noise in frequency spectrum through the Fourier
                                            Transform using python. Below are the graph for time domain and frequency
                                            domain data. In both frequency domain plots, there’s no big spike and
                                            amplitudes are under 0.1, meaning only little noise exists. This is mainly
                                            because the chip's built-in low pass filter is activated by default
                                            according to the page12 of the IMU datasheet. Therefore, a low pass filter
                                            is not needed for the accelerometer. </p>
                                        <img src="assets/img/lab4/g1.png" class="img-thumbnail" alt="...">
                                        <img src="assets/img/lab4/g2.png" class="img-thumbnail" alt="...">
                                        <img src="assets/img/lab4/g3.png" class="img-thumbnail" alt="...">
                                        <img src="assets/img/lab4/g4.png" class="img-thumbnail" alt="...">

                                        <br><br>
                                        <h4 align="left">Task3: Gyroscope</h4>
                                        <p align="left">To compute pitch, roll, and yaw data using the gyroscope, I used
                                            the function below, where I changed the sign of roll to match its sign with
                                            the accelerometer’s roll data. </p>
                                        <img src="assets/img/lab4/code2.png" class="img-thumbnail" alt="...">
                                        <p align="left">Here’s a video comparing the data generated by accelerometer and
                                            gyroscope. </p>
                                        <iframe width="560" height="315" src="https://www.youtube.com/embed/9g_UaDrjidc"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            allowfullscreen></iframe>
                                        <p align="left">According to the video, outputs from gyroscope are less noisy
                                            but have the issue of drifting, meaning that small errors could accumulate
                                            over time. As a result, after a significant amount of time, the readings
                                            would no longer be accurate as they drifted away from the actual values </p>
                                        <br><br>
                                        <p align="left">I also adjusted my delay time from 100 ms to 10 ms to see the
                                            effect of increasing sampling frequency. It appears that increasing the
                                            sampling frequency (decrease delay time) improves the accuracy of my
                                            estimated angles and slightly reduces the drift effect. </p>
                                        <img src="assets/img/lab4/Gyro_100ms.png" class="img-thumbnail" alt="...">
                                        <img src="assets/img/lab4/Gyro_10ms.png" class="img-thumbnail" alt="...">
                                        <p align="left">To get both the low noise feature from gyroscope and no drift
                                            feature from accelerometer data, I implemented a complimentary filter using
                                            the equation below: </p>
                                        <img src="assets/img/lab4/code3.png" class="img-thumbnail" alt="...">
                                        <p align="left">I got stable and accurate estimate angle of pitch and roll with
                                            range of +/- 180 degrees. The results can be seen in the video below. </p>
                                        <iframe width="560" height="315" src="https://www.youtube.com/embed/veMoupFFNaU"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            allowfullscreen></iframe>

                                        <br><br>
                                        <h4 align="left">Task4: Sample Data</h4>
                                        <p align="left">In order to gather IMU data as fast as we can, I removed delays
                                            and print statememt in my code and sent the data whenever ready. I could
                                            collect 805 sets of time-stamped IMU data and sent over bluetooth in 5
                                            seconds. In other words, I was able to sample new values approximately every
                                            6 milliseconds, so 161 times per second. </p>
                                        <img src="assets/img/lab4/sampledata.png" class="img-thumbnail" alt="...">
                                        <iframe width="560" height="315" src="https://www.youtube.com/embed/qaZPDisL4J8"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            allowfullscreen></iframe>
                                        <br><br>
                                        <p align="left">To enable the Artemis to capture both ToF data and IMU data, I
                                            integrated my code from lab3. In the while loop of the Arduino code, I first
                                            start ToF ranging, then check if the IMU data is ready, and then check if
                                            the ToF data is ready. If either one is ready, I’ll append them into
                                            estring. After three sets of data are collected and appended to estring,
                                            they’ll be sent over bluetooth. In this way even the ToF data rate is much
                                            slower than the IMU data rate, they will not hinder each other. </p>
                                        <p align="left">According to the video below, I could collect 585 sets of IMU
                                            data and 49 sets of ToF data sent over bluetooth in 5 seconds. </p>
                                        <iframe width="560" height="315" src="https://www.youtube.com/embed/_bLt_1Sz5VY"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            allowfullscreen></iframe>

                                        <br><br>
                                        <h4 align="left">Task5: Cut the Coord!</h4>
                                        <p align="left">Now it’s time to use batteries! We have two batteries available.
                                            One is 3.7V 850mAh that will be used to power the motors through the motor
                                            drivers. The other is 3.7V 650mAh that will be used to power the digital
                                            electronics (Artemis, sensors, etc.). We used the one with more capacity to
                                            power the car since it consumes more energy. </p>
                                        <img src="assets/img/lab4/battery.png" class="img-thumbnail" alt="...">

                                        <br><br>
                                        <h4 align="left">Task6: Record a Stunt</h4>
                                        <p align="left">After mounting the 850 mAh battery onto the RC car, I played
                                            around with the car and was amazed by its fast movement. I then taped all
                                            the components(the Artemis with battery and sensors) to the car and tried to
                                            record a stunt. </p>
                                        <img src="assets/img/lab4/car.png" class="img-thumbnail" alt="...">
                                        <p align="left">Below are two videos and their graphs platted using collected
                                            data. </p>
                                        <iframe width="560" height="315" src="https://www.youtube.com/embed/ZfEm_PGa_YM"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            allowfullscreen></iframe>
                                        <img src="assets/img/lab4/ToF1.png" class="img-thumbnail" alt="...">
                                        <img src="assets/img/lab4/IMU1.png" class="img-thumbnail" alt="...">

                                        <iframe width="560" height="315" src="https://www.youtube.com/embed/zkXPyA_4u8M"
                                            title="YouTube video player" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            allowfullscreen></iframe>
                                        <img src="assets/img/lab4/ToF2.png" class="img-thumbnail" alt="...">
                                        <img src="assets/img/lab4/IMU2.png" class="img-thumbnail" alt="...">


                                        <button class="btn btn-primary" data-bs-dismiss="modal">
                                            <i class="fas fa-xmark fa-fw"></i>
                                            Close Window
                                        </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Portfolio Modal 5-->
    <div class="portfolio-modal modal fade" id="portfolioModal5" tabindex="-1" aria-labelledby="portfolioModal5"
        aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header border-0"><button class="btn-close" type="button" data-bs-dismiss="modal"
                        aria-label="Close"></button></div>
                <div class="modal-body text-center pb-5">
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8">
                                <!-- Portfolio Modal - Title-->
                                <h2 class="portfolio-modal-title text-secondary text-uppercase mb-0">Lab5</h2>
                                <!-- Icon Divider-->
                                <div class="divider-custom">
                                    <div class="divider-custom-line"></div>
                                    <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                                    <div class="divider-custom-line"></div>
                                </div>
                                <!-- Portfolio Modal - Text-->
                                <p class="mb-4">To be continued...</p>
                                <button class="btn btn-primary" data-bs-dismiss="modal">
                                    <i class="fas fa-xmark fa-fw"></i>
                                    Close Window
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Portfolio Modal 6-->
    <div class="portfolio-modal modal fade" id="portfolioModal6" tabindex="-1" aria-labelledby="portfolioModal6"
        aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header border-0"><button class="btn-close" type="button" data-bs-dismiss="modal"
                        aria-label="Close"></button></div>
                <div class="modal-body text-center pb-5">
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8">
                                <!-- Portfolio Modal - Title-->
                                <h2 class="portfolio-modal-title text-secondary text-uppercase mb-0">Lab6</h2>
                                <!-- Icon Divider-->
                                <div class="divider-custom">
                                    <div class="divider-custom-line"></div>
                                    <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                                    <div class="divider-custom-line"></div>
                                </div>
                                <!-- Portfolio Modal - Text-->
                                <p class="mb-4">To be continued...</p>
                                <button class="btn btn-primary" data-bs-dismiss="modal">
                                    <i class="fas fa-xmark fa-fw"></i>
                                    Close Window
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script>
    <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
    <!-- * *                               SB Forms JS                               * *-->
    <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
    <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
    <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
</body>

</html>